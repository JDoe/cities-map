/*! cities-map - v0.0.1 - 2013-12-06
* https://github.com/TheDahv/cities-map
* Copyright (c) 2013 David Pierce; Licensed MIT */
(function(t,e){e["true"]=t,function(t,e){var a=t.CitiesMap=t.CitiesMap||{},n=a.Data={};n.loadCitiesData=function(t){var a,n;return t=t||{},a={urlBase:"http://swoop.startupweekend.org"},n=e.extend(a,t),e.get(""+n.urlBase+"/cities")}}(window,jQuery),function(t){var e,a=window.google,n=t.CitiesMap=t.CitiesMap||{},r=n.MapApi=function(t,e){return this.mapContainer=t,this.options=e||{programsOfInterest:[]},this.mapRef=null,this.mapPoints={},this.writeMapToElement(),this};e=a&&a.maps?a.maps:void 0,e===void 0?window.alert("The Google Maps API is not available at this time. Please try again later"):(r.prototype.writeMapToElement=function(){var t,a,n=this,r=n.mapContainer,i={};return i.center=new e.LatLng(-34.397,150.644),i.zoom=8,i.mapTypeId=e.MapTypeId.ROADMAP,n.mapRef=new e.Map(r[0],i),n.infoWindowInstance=new e.InfoWindow({map:n.mapRef}),a=i.width||r.data("width")||600,t=i.height||r.data("height")||400,r.css("width",a),r.css("height",t),this.mapRef},r.prototype.createCityPoint=function(t,a){var n=new e.Marker({map:this.mapRef,position:new e.LatLng(t.location[0],t.location[1])});return n.addListener("click",a),this.mapPoints[n.__gm_id]=t,n}),r.prototype.getMarkerShowHandler=function(){var t=this,e=t.mapRef,a=t.infoWindowInstance;return function(n){var r=this,i=r.__gm_id,o=t.mapPoints[i];return a.setContent(t.getCityInfoWindowContent(o)),a.open(e,r),n.stop(),!1}},r.prototype.getCityInfoWindowContent=function(t){var e=this,a="<div class='sw-cities-map'>",n=[],r=e.options.programsOfInterest;return n=0===r.length?t.upcoming_programs:t.upcoming_programs.filter(function(t){return~r.indexOf(t.event_type)}),a+=n.map(function(a){var n="";return n+="<h1>"+a.event_type+" "+t.city+"</h1>",n+=a.events.map(function(t){var n,r,i,o=e.formatDateString(t.start_date);return i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=0|16*Math.random(),a="x"===t?e:8|3&e;return a.toString(16)}),n=/^https?\:\/\//.test(t.website)?a.website:"http://"+t.website,r=/^https?:\/\//.test(t.public_registration_url)?t.public_registration_url:"http://"+t.public_registration_url,"<div class='event-row'><p class='e vent-row__date'>"+o+(t.vertical.length>0?" - "+t.vertical:"")+"</p>"+"<span class='event-row__form-controls'><a href='"+n+"'>More Info</a></span>"+"<span class='event-row__form-controls'><a href='"+r+"'>Sign up</a></span>"+"<label for='"+i+"' class='event-row__notification-trigger'>Future event alerts</label>"+"<input id='"+i+"' type='checkbox' class='event-row__activate-form' />"+"<div class='event-row__form-target'>"+"<form action='#' method='POST'>"+"<input type='text' /><input type='submit' value='Subscribe' />"+"</form></div>"+"</div>"}).join("")}).join(""),a+="</div>"},r.prototype.formatDateString=function(t){var e,a;switch("string"==typeof t&&(t=new Date(t)),t.getUTCDay()){case 0:e="Monday";break;case 1:e="Tuesday";break;case 2:e="Wednesday";break;case 3:e="Thursday";break;case 4:e="Friday";break;case 5:e="Saturday";break;case 6:e="Sunday"}switch(t.getUTCMonth()){case 0:a="January";break;case 1:a="February";break;case 2:a="March";break;case 3:a="April";break;case 4:a="May";break;case 5:a="June";break;case 6:a="July";break;case 7:a="August";break;case 8:a="September";break;case 9:a="October";break;case 10:a="November";break;case 11:a="December";break;default:a=""}return e+", "+a+" "+t.getUTCDate()}}(window),function(t,e){var a=e.Data;t.fn.citiesmap=function(n){var r=t(this),i=a.loadCitiesData(n);i.error(function(t){window.alert(t)}),i.success(function(t){var a=new e.MapApi(r,n),i=a.getMarkerShowHandler();t.forEach(function(t){a.createCityPoint.call(a,t,i)})})}}(jQuery,CitiesMap)})({},function(){return this}());