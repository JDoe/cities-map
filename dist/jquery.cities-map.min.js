/*! cities-map - v0.0.1 - 2013-11-15
* https://github.com/TheDahv/cities-map
* Copyright (c) 2013 David Pierce; Licensed MIT */
(function(t,n){n["true"]=t,function(t,n){var i=t.CitiesMap=t.CitiesMap||{},e=i.Data={};e.loadCitiesData=function(t){var i,e;return t=t||{},i={urlBase:"http://swoop.startupweekend.org"},e=n.extend(i,t),n.get(""+e.urlBase+"/cities")}}(window,jQuery),function(t){var n,i=window.google,e=t.CitiesMap=t.CitiesMap||{},a=e.MapApi=function(t,n){return this.mapContainer=t,this.options=n||{},this.mapRef=null,this.mapPoints={},this.writeMapToElement(),this};n=i&&i.maps?i.maps:void 0,n===void 0?window.alert("The Google Maps API is not available at this time. Please try again later"):(a.prototype.writeMapToElement=function(){var t,i,e=this,a=e.mapContainer,o={};return o.center=new n.LatLng(-34.397,150.644),o.zoom=8,o.mapTypeId=n.MapTypeId.ROADMAP,e.mapRef=new n.Map(a[0],o),e.infoWindowInstance=new n.InfoWindow({map:e.mapRef}),i=o.width||a.data("width")||600,t=o.height||a.data("height")||400,a.css("width",i),a.css("height",t),this.mapRef},a.prototype.createCityPoint=function(t,i){var e=new n.Marker({map:this.mapRef,position:new n.LatLng(t.location[0],t.location[1])});return e.addListener("click",i),this.mapPoints[e.__gm_id]=t,e}),a.prototype.getMarkerShowHandler=function(){var t=this,n=t.mapRef,i=t.infoWindowInstance;return function(e){var a=this,o=a.__gm_id,r=t.mapPoints[o];return i.setContent(t.getCityInfoWindowContent(r)),i.open(n,a),e.stop(),!1}},a.prototype.getCityInfoWindowContent=function(t){var n="<h1>"+t.city+"</h1>";return n+=t.upcoming_programs.map(function(t){var n="";return n+="<h2>Upcoming for "+t.event_type+"</h2>",n+="<ul>",n+=t.events.map(function(t){return"<li><a href='"+t.public_registration_url+"' target='_blank'>"+(t.vertical.length>0?t.vertical+" ":"")+t.start_date+"</a>"+"</li>"}).join(""),n+="</ul>"}).join("")}}(window),function(t,n){var i=n.Data;t.fn.citiesmap=function(e){var a=t(this),o=i.loadCitiesData(e);o.error(function(t){window.alert(t)}),o.success(function(t){var i=new n.MapApi(a,e),o=i.getMarkerShowHandler();t.forEach(function(t){i.createCityPoint.call(i,t,o)})})}}(jQuery,CitiesMap)})({},function(){return this}());