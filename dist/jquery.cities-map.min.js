/*! cities-map - v0.0.1 - 2013-12-04
* https://github.com/TheDahv/cities-map
* Copyright (c) 2013 David Pierce; Licensed MIT */
(function(t,e){e["true"]=t,function(t,e){var a=t.CitiesMap=t.CitiesMap||{},n=a.Data={};n.loadCitiesData=function(t){var a,n;return t=t||{},a={urlBase:"http://swoop.startupweekend.org"},n=e.extend(a,t),e.get(""+n.urlBase+"/cities")}}(window,jQuery),function(t){var e,a=window.google,n=t.CitiesMap=t.CitiesMap||{},i=n.MapApi=function(t,e){return this.mapContainer=t,this.options=e||{},this.mapRef=null,this.mapPoints={},this.writeMapToElement(),this};e=a&&a.maps?a.maps:void 0,e===void 0?window.alert("The Google Maps API is not available at this time. Please try again later"):(i.prototype.writeMapToElement=function(){var t,a,n=this,i=n.mapContainer,r={};return r.center=new e.LatLng(-34.397,150.644),r.zoom=8,r.mapTypeId=e.MapTypeId.ROADMAP,n.mapRef=new e.Map(i[0],r),n.infoWindowInstance=new e.InfoWindow({map:n.mapRef}),a=r.width||i.data("width")||600,t=r.height||i.data("height")||400,i.css("width",a),i.css("height",t),this.mapRef},i.prototype.createCityPoint=function(t,a){var n=new e.Marker({map:this.mapRef,position:new e.LatLng(t.location[0],t.location[1])});return n.addListener("click",a),this.mapPoints[n.__gm_id]=t,n}),i.prototype.getMarkerShowHandler=function(){var t=this,e=t.mapRef,a=t.infoWindowInstance;return function(n){var i=this,r=i.__gm_id,o=t.mapPoints[r];return a.setContent(t.getCityInfoWindowContent(o)),a.open(e,i),n.stop(),!1}},i.prototype.getCityInfoWindowContent=function(t){var e=this,a="<h1>"+t.city+"</h1>";return a+=t.upcoming_programs.map(function(t){var a="";return a+="<h2>Upcoming for "+t.event_type+"</h2>",a+="<ul>",a+=t.events.map(function(t){var a=e.formatDateString(t.start_date);return"<li><a href='"+t.public_registration_url+"' target='_blank'>"+(t.vertical.length>0?t.vertical+" ":"")+a+"</a>"+"</li>"}).join(""),a+="</ul>"}).join("")},i.prototype.formatDateString=function(t){var e;switch("string"==typeof t&&(t=new Date(t)),t.getUTCMonth()){case 0:e="January";break;case 1:e="February";break;case 2:e="March";break;case 3:e="April";break;case 4:e="May";break;case 5:e="June";break;case 6:e="July";break;case 7:e="August";break;case 8:e="September";break;case 9:e="October";break;case 10:e="November";break;case 11:e="December";break;default:e=""}return t.getUTCDate()+" "+e+", "+t.getUTCFullYear()}}(window),function(t,e){var a=e.Data;t.fn.citiesmap=function(n){var i=t(this),r=a.loadCitiesData(n);r.error(function(t){window.alert(t)}),r.success(function(t){var a=new e.MapApi(i,n),r=a.getMarkerShowHandler();t.forEach(function(t){a.createCityPoint.call(a,t,r)})})}}(jQuery,CitiesMap)})({},function(){return this}());