/*! cities-map - v0.0.1 - 2013-12-06
* https://github.com/TheDahv/cities-map
* Copyright (c) 2013 David Pierce; Licensed MIT */
(function(e,t){t["true"]=e,function(e,t){var a=e.CitiesMap=e.CitiesMap||{},n=a.Data={};n.loadCitiesData=function(e){var a,n;return e=e||{},a={urlBase:"http://swoop.startupweekend.org"},n=t.extend(a,e),t.get(""+n.urlBase+"/cities")}}(window,jQuery),function(e){var t,a=window.google,n=window.jQuery,i=e.CitiesMap=e.CitiesMap||{},r=i.MapApi=function(e,t){var a={programsOfInterest:[],notificationUrl:"http://startupweekend.us1.list-manage.com/subscribe/post?u=77bee8d6876e3fd1aa815badb&amp;id=66eed7c427"};return this.mapContainer=e,this.options=n.extend(a,t||{}),this.mapRef=null,this.mapPoints={},this.writeMapToElement(),this};t=a&&a.maps?a.maps:void 0,t===void 0?window.alert("The Google Maps API is not available at this time. Please try again later"):(r.prototype.writeMapToElement=function(){var e,a,n=this,i=n.mapContainer,r={};return r.center=new t.LatLng(-34.397,150.644),r.zoom=8,r.mapTypeId=t.MapTypeId.ROADMAP,n.mapRef=new t.Map(i[0],r),n.infoWindowInstance=new t.InfoWindow({map:n.mapRef}),a=r.width||i.data("width")||600,e=r.height||i.data("height")||400,i.css("width",a),i.css("height",e),this.mapRef},r.prototype.createCityPoint=function(e,a){var n=new t.Marker({map:this.mapRef,position:new t.LatLng(e.location[0],e.location[1])});return n.addListener("click",a),this.mapPoints[n.__gm_id]=e,n}),r.prototype.getMarkerShowHandler=function(){var e=this,t=e.mapRef,a=e.infoWindowInstance;return function(n){var i=this,r=i.__gm_id,o=e.mapPoints[r];return a.setContent(e.getCityInfoWindowContent(o)),a.open(t,i),n.stop(),!1}},r.prototype.getCityInfoWindowContent=function(e){var t=this,a="<div class='sw-cities-map'>",n=[],i=t.options.programsOfInterest;return n=0===i.length?e.upcoming_programs:e.upcoming_programs.filter(function(e){return~i.indexOf(e.event_type)}),a+=n.map(function(a){var n="";return n+="<h1>"+a.event_type+" "+e.city+"</h1>",n+=a.events.map(function(n){var i,r,o,s=t.formatDateString(n.start_date);return o="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=0|16*Math.random(),a="x"===e?t:8|3&t;return a.toString(16)}),i=/^https?\:\/\//.test(n.website)?a.website:"http://"+n.website,r=/^https?:\/\//.test(n.public_registration_url)?n.public_registration_url:"http://"+n.public_registration_url,"<div class='event-row'><p class='event-row__date'>"+s+(n.vertical.length>0?" - "+n.vertical:"")+"</p>"+"<span class='event-row__form-controls'><a href='"+i+"'>More Info</a></span>"+"<span class='event-row__form-controls'><a href='"+r+"'>Sign up</a></span>"+"<label for='"+o+"' class='event-row__notification-trigger'>Future event alerts</label>"+"<input id='"+o+"' type='checkbox' class='event-row__activate-form' />"+"<div class='event-row__form-target'>"+"<form action='"+t.options.notificationUrl+"' method='POST' target='_blank'>"+"<input type='hidden' name='CITY' value='"+e.city+"' />"+"<input type='hidden' name='MMERGE3' value='"+a.event_type+"' />"+"<input type='hidden' name='MMERGE4' value='"+n.vertical+"' />"+"<input type='text' name='EMAIL' /><input type='submit' name='Subscribe' value='Subscribe' />"+"</form></div>"+"</div>"}).join("")}).join(""),a+="</div>"},r.prototype.formatDateString=function(e){var t,a;switch("string"==typeof e&&(e=new Date(e)),e.getUTCDay()){case 0:t="Monday";break;case 1:t="Tuesday";break;case 2:t="Wednesday";break;case 3:t="Thursday";break;case 4:t="Friday";break;case 5:t="Saturday";break;case 6:t="Sunday"}switch(e.getUTCMonth()){case 0:a="January";break;case 1:a="February";break;case 2:a="March";break;case 3:a="April";break;case 4:a="May";break;case 5:a="June";break;case 6:a="July";break;case 7:a="August";break;case 8:a="September";break;case 9:a="October";break;case 10:a="November";break;case 11:a="December";break;default:a=""}return t+", "+a+" "+e.getUTCDate()}}(window),function(e,t){var a=t.Data;e.fn.citiesmap=function(n){var i=e(this),r=a.loadCitiesData(n);r.error(function(e){window.alert(e)}),r.success(function(e){var a=new t.MapApi(i,n),r=a.getMarkerShowHandler();e.forEach(function(e){a.createCityPoint.call(a,e,r)})})}}(jQuery,CitiesMap)})({},function(){return this}());